(this.webpackJsonpsyncify=this.webpackJsonpsyncify||[]).push([[0],{160:function(e,t,n){},264:function(e,t,n){e.exports=n.p+"static/media/logo.daf13776.png"},269:function(e,t,n){e.exports=n(584)},274:function(e,t,n){},275:function(e,t,n){},280:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){},289:function(e,t,n){},315:function(e,t){},318:function(e,t,n){},335:function(e,t,n){},349:function(e,t){},351:function(e,t){},381:function(e,t){},382:function(e,t){},447:function(e,t){},584:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(101),c=n.n(o),i=(n(274),n(25)),u=n(26),l=n(28),s=n(27),p=n(29),d=n(268),m=function(e){return r.a.createElement("div",{className:e.className},e.children)},f=n(22),h=(n(275),function(e){return r.a.createElement("div",null,r.a.createElement("div",{style:{color:"white"}},"Search"),r.a.createElement("input",{type:"search",onChange:function(t){return e.searchChange(t)}}))}),y=n(16),g=(n(280),r.a.createContext()),E=function(e){return r.a.createElement("div",{className:"trackview_container"},e.config.isPlayable?r.a.createElement("div",{className:"trackview_album",onClick:function(){return e.changeSong()}},e.track.album.images.length>0?r.a.createElement("img",{style:{width:"auto",height:e.config.height+e.config.heightUnit},src:e.track.album.images[e.track.album.images.length-1].url,alt:""}):null):r.a.createElement("div",null,e.track.album.images.length>0?r.a.createElement("img",{style:{width:"auto",height:e.config.height+e.config.heightUnit},src:e.track.album.images[e.track.album.images.length-1].url,alt:""}):null),r.a.createElement("div",null,r.a.createElement("div",{style:{color:"white"}},e.track.name),r.a.createElement("div",{style:{color:"white"}},e.track.album.name)),e.config.canQueue?r.a.createElement("div",{onClick:function(){return k(e.socket,e.track,e.userId)}},r.a.createElement("button",null,"+")):r.a.createElement("div",null),e.config.canRemoveQueue?r.a.createElement("div",{onClick:function(){return v(e.socket,e.track.queuePosition,e.userId)}},r.a.createElement("button",null,"-")):r.a.createElement("div",null))},k=function(e,t,n){var a={trackInfo:{trackId:t.id,name:t.name,albumName:t.album.name,albumSrc:t.album.images.length>0?t.album.images[t.album.images.length-1].url:null,uri:t.uri},userInfo:{userId:n}};e.emit("addToQueue",a)},v=function(e,t,n){var a={trackInfo:{queuePosition:t},userInfo:{userId:n}};e.emit("removeFromQueue",a)},b=Object(y.b)((function(e){return{currentSong:e.currentSong,userId:e.user.id}}))((function(e){return r.a.createElement(g.Consumer,null,(function(t){return r.a.createElement(E,Object.assign({},e,{socket:t}))}))})),_=(n(160),function(e){var t={height:4.5,heightUnit:"em",isPlayable:!0,canQueue:!0,canRemoveQueue:!1};return r.a.createElement("div",null,r.a.createElement("h1",null,"Song Results"),e.data.tracks.items.map((function(e,n){return r.a.createElement(m,{key:e.id+"songResults"+n,className:"tracksearchwrapper"},r.a.createElement(b,{track:e,config:t}))})))}),C=n(61),I=n(43),O=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleSearchChange=function(e){n.setState({searchConfig:Object(f.a)({},n.state.searchConfig,{query:e.target.value})})},n.shouldComponentUpdate=function(e,t){return n.state.searchConfig.query!==t.searchConfig.query},n.state={searchConfig:{options:{limit:10},album:!0,artist:!0,playlist:!0,track:!0,query:""},test:null},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"sidebar_container"},r.a.createElement(h,{searchChange:this.handleSearchChange}),this.state.searchConfig.query.length>0?r.a.createElement(C.a,Object.assign({},this.state.searchConfig,{children:function(e,t,n){return e?r.a.createElement(_,{data:e}):r.a.createElement("div",null,"Search for a song")}})):r.a.createElement("div",null,"START SEARCHING"))}}]),t}(a.Component),S=Object(I.g)((function(e){return r.a.createElement(g.Consumer,null,(function(t){return r.a.createElement(O,Object.assign({},e,{socket:t}))}))})),T=(n(287),n(264)),P=n.n(T),j=Object(y.b)(null,(function(e){return{logoutUser:function(){return e({type:"LOGOUT_USER"})}}}))((function(e){return r.a.createElement("div",{className:"Header_header"},r.a.createElement("ul",null,r.a.createElement("li",{className:"Header_logo"},r.a.createElement("img",{href:"/#",src:P.a,alt:""}),r.a.createElement("span",null,"Syncify")),r.a.createElement("li",null,r.a.createElement("a",{onClick:e.logoutUser},"Sign Out")),r.a.createElement("li",null,r.a.createElement("a",{href:"/syncify/home"},"Home"))))})),A=(n(288),function(e){var t={height:3,heightUnit:"em",isPlayable:!1,canQueue:!1,canRemoveQueue:!0};return console.log("config: ",t),r.a.createElement("div",{className:"queuebar_container"},e.queue.map((function(e,n){return r.a.createElement(m,{key:e.trackId+"queue"+n,className:"queuesearchwrapper"},r.a.createElement(b,{track:{name:e.name,uri:e.uri,album:{images:[e.albumSrc]},queuePosition:n},config:t}))})))}),R=(n(289),n(153)),w=n.n(R),N=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).joinRoom=function(e){var t={roomId:e,userId:n.props.userId};n.props.socket.emit("joinRoom",t)},n.state={},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(m,{className:"roommanager_container"},r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("button",null,"create Room"))),r.a.createElement("div",null,"RoomList",r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.joinRoom("room1")}},"room1")),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.joinRoom("room2")}},"room2")),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.joinRoom("room3")}},"room3"))))}}]),t}(a.Component),L=Object(y.b)((function(e){return{userId:e.user.id}}))((function(e){return r.a.createElement(g.Consumer,null,(function(t){return r.a.createElement(N,Object.assign({},e,{socket:t}))}))})),U=(n(318),Object(y.b)((function(e){return{currentSong:e.currentSong,accessToken:e.tokenParams.access_token}}),(function(e){return{changeSong:function(){}}}))((function(e){return r.a.createElement("div",{className:"musicplayerview_container"},r.a.createElement("div",null,"TrackController"),r.a.createElement("div",null,"volume control"),r.a.createElement("button",{onClick:function(){return e.prevClick()}},"PREV"),r.a.createElement("button",{onClick:function(){return e.playClick()}},"PLAY"),r.a.createElement("button",{onClick:function(){return e.nextClick()}},"NEXT"))}))),D=n(103),x=n.n(D),H=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).createEventHandlers=function(){n.player.on("initialization_error",(function(e){console.error("Initialization error ",e),n.setState({playerInitError:!0})})),n.player.on("authentication_error",(function(e){return console.error("Authentication error ",e)})),n.player.on("account_error",(function(e){return console.error("Account error ",e)})),n.player.on("playback_error",(function(e){return console.error("Playback error ",e)})),n.player.on("player_state_changed",(function(e){if(e){var t=e.duration,a=100*e.position/t;if(n.setState({playingInfo:e,playing:!e.paused,positionSliderValue:a}),n.props.isPlaying||e.paused||(n.positionCheckInterval=setInterval((function(){n.checkChangePosition()}),1e3)),n.props.isPlaying&&e.paused&&clearInterval(n.positionCheckInterval),n.props.isPlaying,e.paused,!n.props.currentlyPlaying||n.props.currentlyPlaying!==e.track_window.current_track.name)e.track_window.current_track}})),n.player.on("ready",(function(e){var t=e.device_id;n.setState({deviceId:t},(function(){n.transferPlaybackHere()})),n.player.getVolume().then((function(e){var t=100*e;n.setState({volumeSliderValue:t})}))}))},n.checkForPlayer=function(){if(window.Spotify){clearInterval(n.playerCheckInterval);var e=n.props.accessToken;n.player=new window.Spotify.Player({name:"Syncify Player",getOAuthToken:function(t){t(e)}}),n.player&&(n.createEventHandlers(),n.player.connect(),console.log("success"))}},n.changeSong=function(e){var t=e.position_ms,n=e.spotify_uri,a=e.playerInstance._options,r=a.getOAuthToken,o=a.id;r((function(e){fetch("https://api.spotify.com/v1/me/player/play?device_id=".concat(o),{method:"PUT",body:JSON.stringify({uris:[n],position_ms:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})}))},n.pauseSong=function(e){var t=e.playerInstance._options,n=t.getOAuthToken,a=t.id;n((function(e){fetch("\thttps://api.spotify.com/v1/me/player/pause?device_id=".concat(a),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})}))},n.transferPlaybackHere=function(){var e=n.state.deviceId;fetch("https://api.spotify.com/v1/me/player",{method:"PUT",headers:{Authorization:"Bearer ".concat(n.props.accessToken),"Content-Type":"application/json"},body:JSON.stringify({device_ids:[e],play:!1})}).then((function(e){204===e.status&&x.a.get("https://api.spotify.com/v1/me/player",{headers:{Authorization:"Bearer ".concat(n.props.accessToken)}}).then((function(){n.CheckChangePosition()})).catch((function(e){}))})).catch((function(e){return console.error(e)}))},n.checkChangePosition=function(){n.player.getCurrentState().then((function(e){if(e){var t=e.duration,a=100*e.position/t;a!==n.state.positionSliderValue&&n.setState({positionSliderValue:a});var r=n.milisToMinutesAndSeconds(e.position),o=n.milisToMinutesAndSeconds(e.duration);n.setState({positionStamp:r,durationStamp:o})}}))},n.milisToMinutesAndSeconds=function(e){var t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return t+":"+(n<10?"0":"")+n},n.timeStringToMilis=function(e){var t=e.split(":");return 1e3*(+t[0]+ +t[1])},n.playClick=function(){n.player.getCurrentState().then((function(e){if(e){var t=e.duration,a=100*e.position/t,r=(n.milisToMinutesAndSeconds(e.position),n.milisToMinutesAndSeconds(e.duration),{trackInfo:{uri:e.context.uri,positionTimestamp:e.position,durationTimestamp:e.duration,positionSliderValue:a,paused:e.paused},userInfo:{userId:n.props.userId}});n.props.socket.emit("playClick",r)}}))},n.prevClick=function(){var e={userInfo:{userId:n.props.userId}};n.props.socket.emit("prevClick",e)},n.nextClick=function(){var e={userInfo:{userId:n.props.userId}};n.props.socket.emit("nextClick",e)},n.syncPlayClick=function(e){console.log(e.trackInfo),n.player.getCurrentState().then((function(t){t.context.uri!==e.trackInfo.uri&&n.changeSong({playerInstance:n.player,spotify_uri:e.trackInfo.uri,position_ms:e.trackInfo.positionTimestamp?e.trackInfo.positionTimestamp:0})}))},n.syncPrevClick=function(e){n.changeSong({playerInstance:n.player,spotify_uri:e.trackInfo.uri,position_ms:0})},n.syncNextClick=function(e){n.changeSong({playerInstance:n.player,spotify_uri:e.trackInfo.uri,position_ms:0})},n.updatePlayer=function(e){if(e){var t=Date.now()-new Date(e.startTimestamp)+200;n.changeSong({playerInstance:n.player,spotify_uri:e.uri,position_ms:t})}else n.pausePlayer({playInstance:n.player})},n.pausePlayer=function(){n.pauseSong({playerInstance:n.player})},n.componentDidMount=function(){n.playerCheckInterval=setInterval((function(){return n.checkForPlayer()}),1e3),n.props.socket&&(n.props.socket.on("playClick",(function(e){n.syncPlayClick(e)})),n.props.socket.on("prevClick",(function(e){n.syncPrevClick(e)})),n.props.socket.on("nextClick",(function(e){n.syncNextClick(e)})),n.props.socket.on("pauseClick",(function(e){n.pausePlayer(e)})),n.props.socket.on("updateNewUser",(function(e){n.updatePlayer(e)})))},n.state={deviceId:null,playingInfo:null,playerInitError:!1,playing:!1,positionSliderValue:50,volumeSliderValue:50},n.playerCheckInterval=null,n.player=null,n.positionCheckInterval=null,n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(U,{playClick:this.playClick,prevClick:this.prevClick,nextClick:this.nextClick}))}}]),t}(a.Component),q=Object(y.b)((function(e){return{accessToken:e.tokenParams.access_token,isLoggedIn:e.isLoggedIn,isAuthenticated:e.isAuthenticated,isPlaying:e.isPlaying,userId:e.user.id}}),(function(e){return{setPlayer:function(t){return e({type:"SET_PLAYER",payload:{player:t}})}}}))((function(e){return r.a.createElement(g.Consumer,null,(function(t){return r.a.createElement(H,Object.assign({},e,{socket:t}))}))})),B=(n(335),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).updateQueue=function(e){n.setState({queue:e})},n.componentDidMount=function(){n.socket&&(n.socket.on("updateQueue",(function(e){n.updateQueue(e)})),n.socket.on("updateNewUserQueue",(function(e){n.updateQueue(e)})))},n.state={response:null,queue:[]},n.socket=w()("localhost:4000"),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(g.Provider,{value:this.socket},r.a.createElement(C.b.Provider,{value:this.props.accessToken},r.a.createElement(j,null),r.a.createElement("div",{className:"musicroom_sidebar_container"},r.a.createElement(S,null),r.a.createElement(A,{queue:this.state.queue})),r.a.createElement(L,null),r.a.createElement("div",null,"ChatRoom"),r.a.createElement(q,null)))}}]),t}(a.Component)),Q=Object(I.g)(B),V=n(80),z=Object(I.g)(Object(y.b)((function(e){return{isLoggedIn:e.isLoggedIn,isAuthenticated:e.isAuthenticated}}))((function(e){return e.isAuthenticated?r.a.createElement("div",null,r.a.createElement("div",null,"Authentication Success..."),r.a.createElement(I.a,{to:"/"})):r.a.createElement("div",null,r.a.createElement("div",null,"Logging In..."))}))),M=function(e){return r.a.createElement("div",null,r.a.createElement("label",null,"Email: ")," ",r.a.createElement("input",{type:"text"}),r.a.createElement("label",null,"Password: ")," ",r.a.createElement("input",{type:"text"}),r.a.createElement("button",{onClick:e.authenticateUser},"Submit"),r.a.createElement("div",{hidden:!0}," Invalid User or Password"))},W=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).AccessTokenCallBack=function(e){n.SetAuthentication(e.body)},n.SetAuthentication=function(e){var t=!0;e.includes("error")?t=!1:e=JSON.parse(e),Object(V.c)(e,(function(a){var r={access_token:e.access_token,displayName:a.display_name,email:a.email,id:a.id,type:a.type,country:a.country,product:a.product};n.props.setAuthentication(t,e,r)}))},n.SetAuthState=function(e){n.setState({isAuthenticated:e})},n.componentDidMount=function(){var e=Object(V.a)().code||null;e&&Object(V.b)(e,n.AccessTokenCallBack)},n.authenticateUser=function(){setTimeout((function(){n.props.setUserLogin(!0),window.location.href=Object(V.d)()}),1e3)},n.state={isAuthenticated:!1},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.match;return r.a.createElement("div",null,r.a.createElement(I.d,null,r.a.createElement(I.b,{exact:!0,path:e.path+"/"},r.a.createElement(M,{authenticateUser:this.authenticateUser})," "),r.a.createElement(I.b,{exact:!0,path:e.path+"/authenticate"},r.a.createElement(z,null)," ")))}}]),t}(a.Component),K=Object(I.g)(Object(y.b)((function(e){return{isLoggedIn:e.isLoggedIn,isAuthenticated:e.isAuthenticated}}),(function(e){return{setAuthentication:function(t,n,a){return e({type:"SET_AUTHENTICATION",payload:{authStatus:t,tokenParams:Object(f.a)({},n),user:Object(f.a)({},a)}})},setUserLogin:function(t){return e({type:"SET_LOGIN",payload:{status:t}})}}}))(W)),F=function(e){var t=e.component,n=Object(d.a)(e,["component"]);return r.a.createElement(I.b,Object.assign({},n,{render:function(e){return n.isLoggedIn&&n.isAuthenticated?r.a.createElement(t,e," ",r.a.createElement(C.b.Provider,{value:n.accessToken},r.a.createElement(Q,{accessToken:n.accessToken}))," "):r.a.createElement(I.a,{to:{pathname:"/syncify/logon",state:{from:e.location}}})}}))},Y=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).state={},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(I.d,null,r.a.createElement(I.b,{path:"/syncify/logon",component:K}),r.a.createElement(F,{path:"/",component:m,isLoggedIn:this.props.isLoggedIn,isAuthenticated:this.props.isAuthenticated,accessToken:this.props.accessToken}),r.a.createElement(I.b,{path:"*"},r.a.createElement("div",null,"NO MATCH")))}}]),t}(a.Component),G=Object(I.g)(Object(y.b)((function(e){return{isLoggedIn:e.isLoggedIn,isAuthenticated:e.isAuthenticated,accessToken:e.tokenParams.access_token}}))(Y));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(538);var J=n(265),X=n(42),$=n(158),Z=n(266),ee={isLoggedIn:!1,isAuthenticated:!1,isPlaying:!1,player:null,tokenParams:{},user:{}},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGOUT_USER":return Object(f.a)({},e,{isLoggedIn:!1,isAuthenticated:!1,tokenParams:{},user:{}});case"SET_AUTHENTICATION":return Object(f.a)({},e,{isAuthenticated:t.payload.authStatus,tokenParams:Object(f.a)({},t.payload.tokenParams),user:Object(f.a)({},t.payload.user)});case"SET_LOGIN":return Object(f.a)({},e,{isLoggedIn:t.payload.status});case"SET_PLAYER":return Object(f.a)({},e,{player:Object(f.a)({},t.payload.player)});default:return e}},ne={key:"root",storage:n.n(Z).a},ae=Object($.a)(ne,te),re=function(){var e=Object(X.c)(ae);return{store:e,persistor:Object($.b)(e)}},oe=n(49),ce=n(267),ie=n.n(ce);c.a.render(r.a.createElement(y.a,{store:re().store},r.a.createElement(J.a,{loading:null,persistor:re().persistor},r.a.createElement(oe.a,null,r.a.createElement(ie.a,{isHydrating:!0,type:"text/javascript",src:"https://sdk.scdn.co/spotify-player.js"}),r.a.createElement(G,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},80:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return d}));var a=n(103),r=n.n(a),o=n(336),c="e1a6860ed0054748985a5975339d8878",i="http://localhost:3000/syncify/logon/authenticate",u=["streaming","user-read-email","user-read-private","user-read-playback-state","user-modify-playback-state","user-library-read","user-library-modify"];function l(t,n){var a={grant_type:"authorization_code",code:t,redirect_uri:i},r={"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+new e(c+":e29adc466d934ada9ea8cf7212845b1a").toString("base64")};o.post({url:"https://accounts.spotify.com/api/token",form:a,headers:r},(function(e,t){n(t)}))}var s=function(e,t){"access_token"in e?r.a.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(e.access_token)}}).then((function(e){var n=e.data;console.log(n),t(n)})).catch((function(e){return console.log(e)})):window.location="https://accounts.spotify.com/authorize?client_id=".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/Syncify",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CLIENT_ID:"e1a6860ed0054748985a5975339d8878",REACT_APP_CLIENT_SECRET:"e29adc466d934ada9ea8cf7212845b1a",REACT_APP_REDIRECT_URI:"http://localhost:3000/syncify/logon/authenticate"}).REACT_APP_SPOTIFY_CLIENT_ID,"&redirect_uri=").concat(Object({NODE_ENV:"production",PUBLIC_URL:"/Syncify",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CLIENT_ID:"e1a6860ed0054748985a5975339d8878",REACT_APP_CLIENT_SECRET:"e29adc466d934ada9ea8cf7212845b1a",REACT_APP_REDIRECT_URI:"http://localhost:3000/syncify/logon/authenticate"}).REACT_APP_SPOTIFY_REDIRECT_URI,"&scope=").concat(Object({NODE_ENV:"production",PUBLIC_URL:"/Syncify",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CLIENT_ID:"e1a6860ed0054748985a5975339d8878",REACT_APP_CLIENT_SECRET:"e29adc466d934ada9ea8cf7212845b1a",REACT_APP_REDIRECT_URI:"http://localhost:3000/syncify/logon/authenticate"}).REACT_APP_SPOTIFY_SCOPE,"&response_type=token")};function p(){return"".concat("https://accounts.spotify.com/authorize?","client_id=").concat(c,"&redirect_uri=").concat(i,"&scope=").concat(u.join("%20"),"&response_type=code&show_dialog=true")}function d(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,n,a){e[n]=a})),e}}).call(this,n(5).Buffer)}},[[269,1,2]]]);
//# sourceMappingURL=main.d3e1882d.chunk.js.map